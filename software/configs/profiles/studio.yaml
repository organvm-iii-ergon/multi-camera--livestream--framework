# studio.yaml - Primary M1 Mac Studio streaming configuration
#
# This profile defines the complete hardware and software setup for
# the main streaming workstation. Uses category-based ontology for
# flexible hardware/software abstraction.
#
# Categories allow scripts to reference hardware by role (e.g., "audio_interface")
# rather than specific model, enabling profile switching without script changes.

profile:
  name: "studio"
  description: "Primary M1 Mac Studio multi-camera 4K streaming setup"
  version: "1.0.0"

# =============================================================================
# HARDWARE CONFIGURATION
# =============================================================================

hardware:
  # -------------------------------------------------------------------------
  # Computer
  # -------------------------------------------------------------------------
  computer:
    category: "workstation"
    model: "Mac Studio"
    chip: "M1 Ultra"
    ram_gb: 128
    os_version: "14.2.1"
    os_name: "Sonoma"

  # -------------------------------------------------------------------------
  # Video Capture - PCIe card in Thunderbolt chassis
  # -------------------------------------------------------------------------
  video_capture:
    category: "pcie_capture"
    vendor: "Blackmagic Design"
    model: "DeckLink Quad HDMI"
    driver_version: "13.2"
    driver_arch: "arm64"
    inputs: 4
    max_resolution: "2160p30"
    # Search patterns for hardware detection
    detection_patterns:
      - "decklink"
      - "blackmagic"
    # Thunderbolt enclosure
    enclosure:
      vendor: "Sonnet"
      model: "Echo Express SE I"
      interface: "Thunderbolt 3"
      detection_patterns:
        - "echo"
        - "sonnet"

  # -------------------------------------------------------------------------
  # Audio Interface - Dante-enabled
  # -------------------------------------------------------------------------
  audio_interface:
    category: "dante_interface"
    vendor: "MOTU"
    model: "8PRE-ES"
    driver_version: "2.23.5"
    dante_enabled: true
    channels_in: 24
    channels_out: 28
    sample_rates:
      - 44100
      - 48000
      - 88200
      - 96000
    # Search patterns for hardware detection
    detection_patterns:
      - "motu"
    preference_pane_paths:
      - "/Library/PreferencePanes/MOTU Audio.prefPane"
      - "$HOME/Library/PreferencePanes/MOTU Audio.prefPane"

  # -------------------------------------------------------------------------
  # Network Equipment
  # -------------------------------------------------------------------------
  network:
    dante_switch:
      model: "Dedicated Gigabit Switch"
      ports: 8
      notes: "Isolated Dante network recommended"
    primary_interface: "en0"

# =============================================================================
# SOFTWARE CONFIGURATION
# =============================================================================

software:
  # -------------------------------------------------------------------------
  # Required Applications
  # -------------------------------------------------------------------------
  required:
    # DAW / Audio Mixer (Dante clock master)
    daw_app:
      category: "audio_mixer"
      name: "Ableton Live"
      bundle_id: "com.ableton.live"
      version: "12.0.10"
      process_names:
        - "Ableton Live"
        - "Live"
        - "Ableton"
      role: "Audio mixing, Dante clock master"
      launch_order: 3

    # Video Mixer / Streaming Software
    video_mixer:
      category: "streaming_switcher"
      name: "OBS Studio"
      bundle_id: "com.obsproject.obs-studio"
      version: "29.1.3"
      process_names:
        - "OBS"
        - "obs"
      role: "Video mixing, encoding, streaming"
      launch_order: 4

    # Audio Routing Controller
    audio_routing:
      category: "dante_controller"
      name: "Dante Controller"
      bundle_id: "com.audinate.dante.DanteController"
      version: "4.5.3"
      process_names:
        - "Dante"
        - "DanteController"
      role: "Audio network routing and monitoring"
      launch_order: 1

  # -------------------------------------------------------------------------
  # Optional Applications
  # -------------------------------------------------------------------------
  optional:
    # Dante Virtual Soundcard
    dante_virtual_soundcard:
      category: "virtual_audio"
      name: "Dante Virtual Soundcard"
      bundle_id: "com.audinate.dante.DVS"
      process_names:
        - "DVS"
      role: "Software-based Dante endpoints"

    # Device Discovery
    device_manager:
      category: "device_discovery"
      name: "MOTU Discovery"
      bundle_id: "com.motu.MOTUDiscovery"
      process_names:
        - "MOTU"
        - "MOTUDiscovery"
      role: "MOTU device management"
      launch_order: 2

    # 3D Graphics
    graphics:
      category: "3d_graphics"
      name: "Blender"
      bundle_id: "org.blenderfoundation.blender"
      process_names:
        - "Blender"
        - "blender"
      role: "Real-time graphics overlay"

# =============================================================================
# STREAMING ENDPOINTS
# =============================================================================

streaming:
  primary:
    platform: "YouTube"
    rtmp_endpoint: "a.rtmp.youtube.com"
    backup_endpoint: "b.rtmp.youtube.com"
  backup:
    platform: "Twitch"
    rtmp_endpoint: "live.twitch.tv"

# =============================================================================
# OPERATIONAL NOTES
# =============================================================================

notes:
  pre_stream: |
    1. Power on MOTU 8PRE-ES first (Dante clock master)
    2. Power on Echo Express chassis
    3. Verify all HDMI sources connected
    4. Run health-check.sh
  post_stream: |
    1. Stop streaming in OBS
    2. Save Ableton project
    3. Run shutdown-studio.sh
    4. Power off hardware in reverse order
  hardware_shutdown_order:
    - "Cameras"
    - "MOTU 8PRE-ES"
    - "Echo Express Chassis"
    - "Mac Studio (optional)"
